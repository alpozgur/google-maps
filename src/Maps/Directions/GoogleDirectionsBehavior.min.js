Type.registerNamespace("Velyo.Google.Maps");Velyo.Google.Maps.DirectionsBehavior=function(n){Velyo.Google.Maps.DirectionsBehavior.initializeBase(this,[n])};Velyo.Google.Maps.DirectionsBehavior.prototype={initialize:function(){Velyo.Google.Maps.DirectionsBehavior.callBaseMethod(this,"initialize");Velyo.Google.Maps.Worker.queue(Function.createDelegate(this,this._attach))},dispose:function(){this._detach();Velyo.Google.Maps.DirectionsBehavior.callBaseMethod(this,"dispose")}},function(n){function t(n){Velyo.Google.Maps.Log.error("Directions routing failed with status: "+n)}function i(n,i){var u,r;i==google.maps.DirectionsStatus.OK?(u=!1,(u=!this.renderer)&&(r={draggable:this.draggable,hideRouteList:this.hideRouteList,map:this.map,preserveViewport:this.preserveViewport,routeIndex:this.routeIndex},this.markerOptions&&(r.markerOptions=this.markerOptions),this.panelId&&(r.panel=document.getElementById(this.panelId)),this.polylineOptions&&(r.polylineOptions=this.polylineOptions),this.suppressBicyclingLayer&&(r.suppressBicyclingLayer=this.suppressBicyclingLayer),this.suppressInfoWindows&&(r.suppressInfoWindows=this.suppressInfoWindows),this.suppressMarkers&&(r.suppressMarkers=this.suppressMarkers),this.suppressPolylines&&(r.suppressPolylines=this.suppressPolylines),this.renderer=new google.maps.DirectionsRenderer(r)),this.renderer.setDirections(n),u&&this.composeEvents(this.renderer,null)):t(i)}n.map=null;n.renderer=null;n.service=null;n.get_name=function(){return this.name};n.set_name=function(n){this.name=n};n.get_avoidHighways=function(){return this.avoidHighways?this.avoidHighways:!1};n.set_avoidHighways=function(n){this.avoidHighways=n};n.get_avoidTolls=function(){return this.avoidTolls?this.avoidTolls:!1};n.set_avoidTolls=function(n){this.avoidTolls=n};n.get_destination=function(){return this.destination};n.set_destination=function(n){this.destination=n};n.get_optimizeWaypoints=function(){return this.optimizeWaypoints?this.optimizeWaypoints:!1};n.set_optimizeWaypoints=function(n){this.optimizeWaypoints=n};n.get_origin=function(){return this.origin};n.set_origin=function(n){this.origin=n};n.get_provideRouteAlternatives=function(){return this.provideRouteAlternatives?this.provideRouteAlternatives:!1};n.set_provideRouteAlternatives=function(n){this.provideRouteAlternatives=n};n.get_region=function(){return this.region};n.set_region=function(n){this.region=n};n.get_travelMode=function(){return this.travelMode};n.set_travelMode=function(n){this.travelMode=n};n.get_unitSystem=function(){return this.unitSystem};n.set_unitSystem=function(n){this.unitSystem=n};n.get_waypoints=function(){return this.waypoints};n.set_waypoints=function(n){this.waypoints=n};n.get_draggable=function(){return this.draggable};n.set_draggable=function(n){this.draggable=n};n.get_hideRouteList=function(){return this.hideRouteList};n.set_hideRouteList=function(n){this.hideRouteList=n};n.get_markerOptions=function(){return this.markerOptions};n.set_markerOptions=function(n){this.markerOptions=n};n.get_panelId=function(){return this.panelId};n.set_panelId=function(n){this.panelId=n};n.get_polylineOptions=function(){return this.polylineOptions};n.set_polylineOptions=function(n){this.polylineOptions=n};n.get_preserveViewport=function(){return this.preserveViewport};n.set_preserveViewport=function(n){this.preserveViewport=n};n.get_routeIndex=function(){return this.routeIndex};n.set_routeIndex=function(n){this.routeIndex=n};n.get_suppressBicyclingLayer=function(){return this.suppressBicyclingLayer};n.set_suppressBicyclingLayer=function(n){this.suppressBicyclingLayer=n};n.get_suppressInfoWindows=function(){return this.suppressInfoWindows};n.set_suppressInfoWindows=function(n){this.suppressInfoWindows=n};n.get_suppressMarkers=function(){return this.suppressMarkers};n.set_suppressMarkers=function(n){this.suppressMarkers=n};n.get_suppressPolylines=function(){return this.suppressPolylines};n.set_suppressPolylines=function(n){this.suppressPolylines=n};n._attach=function(){var n=$find(this.get_element().id);n&&n.add_mapLoaded(Function.createDelegate(this,this.create))};n._detach=function(){this.renderer&&google.maps.event.clearInstanceListeners(this.renderer)};n.create=function(){var u,n,t,r;this.service||(this.service=new google.maps.DirectionsService);this.map||(u=$find(this.get_element().id),u&&(this.map=u.map));n={destination:this.destination,origin:this.origin,travelMode:eval("google.maps.TravelMode."+this.travelMode)};t=this.destination;n.destination=t.Latitude&&t.Longitude?new google.maps.LatLng(t.Latitude,t.Longitude):t;r=this.origin;n.origin=r.Latitude&&r.Longitude?new google.maps.LatLng(r.Latitude,r.Longitude):r;this.avoidHighways&&(n.avoidHighways=this.avoidHighways);this.avoidTolls&&(n.avoidTolls=this.avoidTolls);this.optimizeWaypoints&&(n.optimizeWaypoints=this.optimizeWaypoints);this.provideRouteAlternatives&&(n.provideRouteAlternatives=this.provideRouteAlternatives);this.region&&(n.region=this.region);this.unitSystem&&(n.unitSystem=this.unitSystem);this.waypoints&&(n.waypoints=this.waypoints);n.origin&&n.destination?this.service.route(n,Function.createDelegate(this,i)):(this.origin||Velyo.Google.Maps.Log.warn("GoogleDirections: origin value is missing!"),this.destination||Velyo.Google.Maps.Log.warn("GoogleDirections: destination value is missing!"))};n.getDirections=function(){return this.renderer.getDirections()};n.getMap=function(){return this.renderer.getMap()};n.getPanel=function(){return this.renderer.getPanel()};n.getRouteIndex=function(){return this.renderer.getRouteIndex()};n.setDirections=function(n){this.renderer.setDirections(n)};n.setMap=function(n){this.renderer.setMap(n);this.map=n};n.setOptions=function(n){this.renderer.setOptions(n)};n.setPanel=function(n){this.renderer.setPanel(n)};n.setRouteIndex=function(n){this.renderer.setRouteIndex(n);this.routeIndex=n}}(Velyo.Google.Maps.DirectionsBehavior.prototype),function(n){function t(n){var t=this.get_events().getHandler("changed");t&&t(this,n)}n.composeEvents=function(n,i){this.listener||(n=n||this.renderer,n&&(i=i||this.get_events().getHandler("changed"),i&&(this.listener=google.maps.event.addListener(n,"directions_changed",Function.createDelegate(this,t)))))};n.add_changed=function(n){this.get_events().addHandler("changed",n);this.composeEvents(null,n)};n.remove_changed=function(n){if(this.get_events().removeHandler("changed",n),this.listener){var t=this.get_events().getHandler("changed");t||google.maps.event.removeListener(this.listener)}}}(Velyo.Google.Maps.DirectionsBehavior.prototype);Velyo.Google.Maps.DirectionsBehavior.raiseServerChanged=function(n){var u=n.getDirections().routes,f={name:"change"},r,t,i;if(u&&u.length>0&&(r=u[0].legs,r&&r.length)){for(t=r[0],delete t.via_waypoint,delete t.via_waypoints,t.end_location={Latitude:t.end_location.Ma,Longitude:t.end_location.Na},t.start_location={Latitude:t.start_location.Ma,Longitude:t.start_location.Na},i=0;i<t.steps.length;i++)delete t.steps[i].encoded_lat_lngs,delete t.steps[i].end_point,delete t.steps[i].lat_lngs,delete t.steps[i].path,delete t.steps[i].polyline,delete t.steps[i].start_point,delete t.steps[i].travel_mode,t.steps[i].end_location={Latitude:t.steps[i].end_location.Ma,Longitude:t.steps[i].end_location.Na},t.steps[i].start_location={Latitude:t.steps[i].start_location.Ma,Longitude:t.steps[i].start_location.Na};f.route=t}__doPostBack(n.get_name(),Sys.Serialization.JavaScriptSerializer.serialize(f))};Velyo.Google.Maps.DirectionsBehavior.registerClass("Velyo.Google.Maps.DirectionsBehavior",Sys.UI.Behavior);